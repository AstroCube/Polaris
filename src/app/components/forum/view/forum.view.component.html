<section>
  <div class="row">
    <div class="col-3-of-4">
      <div class="forum__tree">
        <div class="breadcrumb">
          <div class="breadcrumb__section">
            <a class="breadcrumb__link" routerLink="/foro">Foro</a>
            <a *ngIf="forum_data.breadcrumb.parent" class="breadcrumb__link" routerLink="{{'/foro/' + forum_data.breadcrumb.parent._id}}">{{forum_data.breadcrumb.parent.name}}</a>
            <a class="breadcrumb__link" routerLink="{{'/foro/' + forum_data.breadcrumb.actual._id}}">{{forum_data.breadcrumb.actual.name}}</a>
          </div>
        </div>
        <div class="forum__title">
          <h1 class="heading"><a routerLink="{{'/foro/' + forum_data.breadcrumb.actual._id}}">{{forum_info.info.name}}</a></h1>
          <p *ngIf="forum_info.info.description" class="paragraph">{{forum_info.info.description}}</p>
        </div>
        <div class="forum__subforums">
          <div *ngFor="let sub_forum of forum_info.sub_forums" class="subforum">
            <div class="subforum__title">
              <fa-icon class="subforum__title-image" [icon]="faEllipsisV"></fa-icon>
              <a class="subforum__title-link" routerLink="{{'/foro/' + sub_forum.id}}">{{sub_forum.name}}</a>
            </div>
            <div class="subforum__indicator">
              <span *ngIf="sub_forum.new_topics !== 0" class="forum__new" tooltip content="{{'Tienes ' + sub_forum.new_topics + ' temas por ver en este foro'}}" placement="top">{{sub_forum.new_topics}}</span>
              <span class="subforum__number">{{sub_forum.count}}</span>
            </div>
            <div class="subforum__indicator">
            </div>
            <div *ngIf="sub_forum.last_topic" class="subforum__last">
              <a routerLink="{{'/foro/tema/' + sub_forum.last_topic.id}}" class="subforum__top">
                {{sub_forum.last_topic.subject}}
              </a>
              <div class="subforum__bottom">
                <img src="{{'https://mc-heads.net/avatar/' + sub_forum.last_topic.writer.skin}}" alt="Category image" class="subforum__avatar">
                <a [style.color]="sub_forum.last_topic.writer.user_color" routerLink="{{'/' + sub_forum.last_topic.writer.username}}" class="subforum__username">{{sub_forum.last_topic.writer.username}}</a>
                <span tooltip content="Creado en {{sub_forum.last_topic.created_at | valueOf | amLocale: 'es' | amDateFormat:'MMMM Do YYYY, h:mm:ss a'}}" placement="top" class="subforum__date">{{sub_forum.last_topic.created_at | valueOf | amLocale: 'es' | amTimeAgo}}</span>
              </div>
            </div>
          </div>
        </div>
        <div class="u-margin-bottom-small u-margin-top-small u-right-text">
          <a (click)="readAll()" class="btn btn--secondary shop__description-slug-button shop__cart-button"><fa-icon [icon]="faListUl"></fa-icon> Leer todo</a>
          <a *ngIf="this.forum_data.permissions.create" (click)="newTopic()" class="btn btn--primary shop__description-slug-button shop__cart-button"><fa-icon [icon]="faPlus"></fa-icon> Crear tema</a>
        </div>
        <div class="forum__topics">
          <div class="forum__topics-header">
            <div class="forum__topics-header-title">
              Título
            </div>
            <div class="forum__topics-header-indicator">
              Mensajes
            </div>
            <div class="forum__topics-header-indicator">
              Visitas
            </div>
            <div class="forum__topics-header-last">
              Último mensaje
            </div>
          </div>
          <div *ngIf="!forum_info.topics && !forum_info.pinned_topics" class="u-margin-top-small u-center-text paragraph--white">No hay temas para mostrar en este foro.</div>
          <div *ngFor="let topic of forum_info.pinned_topics" class="forum__node">
            <div class="forum__node-title">
              <div class="forum__node-topic">
                <a routerLink="{{'/foro/tema/' + topic.id}}" class="forum__node-title-link">{{topic.subject}}</a>
                <a routerLink="{{'/' + topic.writer.username}}" class="forum__node-author" [style.color]="topic.writer.user_color">
                  <img src="{{'https://mc-heads.net/avatar/' + topic.writer.skin}}" alt="Test" class="forum__node-user-avatar">
                  <span class="forum__node-username">{{topic.writer.username}}</span>
                </a>
                <span tooltip content="Creado en {{topic.created_at | valueOf | amLocale: 'es' | amDateFormat:'MMMM Do YYYY, h:mm:ss a'}}" placement="top" class="forum__node-date">{{topic.created_at | valueOf | amLocale: 'es' | amTimeAgo}}</span>
              </div>
              <div class="forum__node-icons">
                <fa-icon *ngIf="topic.pinned" class="forum__node-icon" [icon]="faThumbtack" tooltip content="Anclado" placement="top"></fa-icon>
                <fa-icon *ngIf="topic.lock" class="forum__node-icon" [icon]="faLock" tooltip content="Bloqueado" placement="top"></fa-icon>
                <fa-icon *ngIf="topic.official" class="forum__node-icon" [icon]="faBookmark" tooltip content="Respuesta Oficial" placement="top"></fa-icon>
              </div>
            </div>
            <div class="forum__node-indicator">
              <span *ngIf="topic.unread !== 0" class="forum__new" tooltip content="{{'Tienes ' + topic.unread + ' mensajes por leer en este tema'}}" placement="top">{{topic.unread}}</span>
              <span class="forum__node-number">{{topic.posts}}</span>
            </div>
            <div class="forum__node-indicator">
              <span class="forum__node-number">{{topic.views.length}}</span>
            </div>
            <div class="forum__node-last">
              <a routerLink="{{'/' + topic.last_message.writer.username}}" class="forum__node-top">
                <img src="{{'https://mc-heads.net/avatar/' + topic.last_message.writer.skin}}" alt="Category image" class="forum__node-avatar">
                <span class="forum__node-username" [style.color]="topic.last_message.writer.user_color">{{topic.last_message.writer.username}}</span>
              </a>
              <div class="forum__node-bottom">
                <span tooltip content="Creado en {{topic.last_message.created_at | valueOf | amLocale: 'es' | amDateFormat:'MMMM Do YYYY, h:mm:ss a'}}" placement="top" class="forum__node-date">{{topic.last_message.created_at | valueOf | amLocale: 'es' | amTimeAgo}}</span>
              </div>
            </div>
          </div>
          <div *ngFor="let topic of forum_info.topics" class="forum__node">
            <div class="forum__node-title">
              <div class="forum__node-topic">
                <a routerLink="{{'/foro/tema/' + topic.id}}" class="forum__node-title-link">{{topic.subject}}</a>
                <a routerLink="{{'/' + topic.writer.username}}" class="forum__node-author" [style.color]="topic.writer.user_color">
                  <img src="{{'https://mc-heads.net/avatar/' + topic.writer.skin}}" alt="Test" class="forum__node-user-avatar">
                  <span class="forum__node-username">{{topic.writer.username}}</span>
                </a>
                <span tooltip content="Creado en {{topic.created_at | valueOf | amLocale: 'es' | amDateFormat:'MMMM Do YYYY, h:mm:ss a'}}" placement="top" class="forum__node-date">{{topic.created_at | valueOf | amLocale: 'es' | amTimeAgo}}</span>
              </div>
              <div class="forum__node-icons">
                <fa-icon *ngIf="topic.pinned" class="forum__node-icon" [icon]="faThumbtack" tooltip content="Anclado" placement="top"></fa-icon>
                <fa-icon *ngIf="topic.lock" class="forum__node-icon" [icon]="faLock" tooltip content="Bloqueado" placement="top"></fa-icon>
                <fa-icon *ngIf="topic.official" class="forum__node-icon" [icon]="faBookmark" tooltip content="Respuesta Oficial" placement="top"></fa-icon>
              </div>
            </div>
            <div class="forum__node-indicator">
              <span *ngIf="topic.unread !== 0" class="forum__new" tooltip content="{{'Tienes ' + topic.unread + ' mensajes por leer en este tema'}}" placement="top">{{topic.unread}}</span>
              <span class="forum__node-number">{{topic.posts}}</span>
            </div>
            <div class="forum__node-indicator">
              <span class="forum__node-number">{{topic.views.length}}</span>
            </div>
            <div class="forum__node-last">
              <a routerLink="{{'/' + topic.last_message.writer.username}}" class="forum__node-top">
                <img src="{{'https://mc-heads.net/avatar/' + topic.last_message.writer.skin}}" alt="Category image" class="forum__node-avatar">
                <span class="forum__node-username" [style.color]="topic.last_message.writer.user_color">{{topic.last_message.writer.username}}</span>
              </a>
              <div class="forum__node-bottom">
                <span tooltip content="Creado en {{topic.last_message.created_at | valueOf | amLocale: 'es' | amDateFormat:'MMMM Do YYYY, h:mm:ss a'}}" placement="top" class="forum__node-date">{{topic.last_message.created_at | valueOf | amLocale: 'es' | amTimeAgo}}</span>
              </div>
            </div>
          </div>
        </div>
        <pagination [centered]="true" [actual_page]="forum_info.page" [last_page]="forum_info.pages" [route]="'/forum/'"></pagination>
      </div>
    </div>
    <div class="col-1-of-4">
      <forum-feed></forum-feed>
    </div>
  </div>
</section>
