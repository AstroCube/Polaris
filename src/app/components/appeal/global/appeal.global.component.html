<section>
  <div class="row u-margin-bottom-small">
    <div class="col-3-of-4">
      <h1 class="heading heading--primary">Lista de apelaciones</h1>
    </div>
    <div class="col-1-of-4">
      <div class="appeal__classifier">
        <div class="classifier">
        <span class="classifier__label" classifier>
            <span *ngIf="type == 'all'">Todos</span>
          <span *ngIf="type == 'open'">Abiertas</span>
          <span *ngIf="type == 'closed'">Cerradas</span>
          <span *ngIf="type == 'escalated'">Escaladas</span>
          <span *ngIf="type == 'involved'">Involucrado</span>
          <span *ngIf="type == 'waiting'">Esperando</span>
        </span>
          <div class="classifier__content">
            <a href="{{'/apelaciones/' + page + '/all'}}" [class.classifier__option--active]="type =='all'" class="classifier__option">Todos</a>
            <a href="{{'/apelaciones/' + page + '/open'}}" [class.classifier__option--active]="type =='open'" class="classifier__option">Abiertas</a>
            <a href="{{'/apelaciones/' + page + '/closed'}}" [class.classifier__option--active]="type =='closed'" class="classifier__option">Cerradas</a>
            <a href="{{'/apelaciones/' + page + '/escalated'}}" [class.classifier__option--active]="type =='escalated'" class="classifier__option">Escaladas</a>
            <a href="{{'/apelaciones/' + page + '/involved'}}" [class.classifier__option--active]="type =='involved'" class="classifier__option">Involucrado</a>
            <a href="{{'/apelaciones/' + page + '/waiting'}}" [class.classifier__option--active]="type =='waiting'" class="classifier__option">Esperando</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="table--black table--fixed">
    <div class="table__header">
      <div class="table__cell appeal__table-small">
        <p>Estado</p>
      </div>
      <div class="table__cell appeal__table-small">
        <p>Encargado</p>
      </div>
      <div class="table__cell appeal__table-large">
        <p>Última acción</p>
      </div>
      <div class="table__cell appeal__table-small">
        <p>Fecha</p>
      </div>
      <div class="table__cell appeal__table-buttons">
        <p>Acciones</p>
      </div>
    </div>
    <div *ngFor="let appeal of appeals" class="table__row">
      <div class="table__cell appeal__table-small">
        <span *ngIf="appeal.status == 'appealing'" style="color: aqua">Apelando</span>
        <span *ngIf="appeal.status == 'appealed'" style="color: green">Apelada</span>
        <span *ngIf="appeal.status == 'closed'" style="color: gray">Cerrada</span>
        <span *ngIf="appeal.status == 'locked'" style="color: red">Bloqueada</span>
        <span *ngIf="appeal.status == 'escalated'" style="color: darkorange">Escalada</span>
      </div>
      <div class="table__cell appeal__table-small">
        <a [style.color]="appeal.staff.user_color" routerLink="{{'/' + appeal.staff.username}}">{{appeal.staff.username}}</a>
      </div>
      <div class="table__cell appeal__table-large">
        <p>
          <span *ngIf="appeal.last_action.action == 'create'">Creada por </span>
          <span *ngIf="appeal.last_action.action == 'open'">Abierta por </span>
          <span *ngIf="appeal.last_action.action == 'close'">Cerrada por </span>
          <span *ngIf="appeal.last_action.action == 'lock'">Bloqueada por </span>
          <span *ngIf="appeal.last_action.action == 'unlock'">Desbloqueada por </span>
          <span *ngIf="appeal.last_action.action == 'comment'">Respuesta de </span>
          <span *ngIf="appeal.last_action.action == 'escalate'">Escalada por </span>
          <span *ngIf="appeal.last_action.action == 'assign-escalate'">Asignada a </span>
          <span *ngIf="appeal.last_action.action == 'appeal'">Apelada por </span>
          <span *ngIf="appeal.last_action.action == 'un-appeal'">Des-apelada por </span>
          <a [style.color]="appeal.last_action.user.user_color" routerLink="{{'/' + appeal.last_action.user.username}}">{{appeal.last_action.user.username}}</a>
        </p>
      </div>
      <div class="table__cell appeal__table-small">
        <span>{{appeal.last_action.created_at | valueOf | amLocale: 'es' | amTimeAgo}}</span>
      </div>
      <div class="table__cell appeal__table-buttons">
        <a *ngIf="appeal.status == 'escalated' && !appeal.involved" (click)="assignAppeal(appeal.id)" class="btn btn--blue shop__description-slug-button shop__cart-button">Asignar</a>
        <a *ngIf="appeal.involved" routerLink="{{'/apelar/' + appeal.id}}" class="btn btn--blue shop__description-slug-button shop__cart-button">Ver</a>
      </div>
    </div>
  </div>
  <p *ngIf="!appeals" class="u-center-text u-margin-top-small paragraph--white">No se han encontrado apelaciones.</p>
</section>
