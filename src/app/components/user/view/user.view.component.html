<section>

  <div class="row">
    <div class="col-1-of-2">
      <h1 class="heading heading--primary profile__name">{{user.username}}</h1>
    </div>
    <!--
    <div class="col-1-of-2 u-right-text" *ngIf="!logged_details.own_profile && logged_details.logged">
      <a href="#" *ngIf="!logged_details.are_friends" class="btn btn--green btn--uppercase btn--strong profile__button"><fa-icon [icon]="faUserPlus"></fa-icon> Añadir amigo</a>
      <a href="#" *ngIf="logged_details.are_riends" class="btn btn--red btn--uppercase btn--strong profile__button"><fa-icon [icon]="faUserTimes"></fa-icon> Eliminar amigo</a>
      <div class="profile__dropdown" *ngIf="logged_details.can_punish">
        <div class="profile__dropdown-label">
          <span class="btn btn--blue btn--uppercase btn--strong profile__button"><fa-icon [icon]="faUserTie"></fa-icon></span>
        </div>
        <div class="profile__dropdown-content">
          <a href="#" class="profile__dropdown-link" *ngIf="logged_details.can_punish"><fa-icon [icon]="faGavel"></fa-icon> Sancionar</a>
        </div>
      </div>
    </div>
    -->
  </div>
  <div class="profile__content">
    <div class="profile__content--left">
      <div class="profile__content-section">
        <div class="profile__content-indicator">
          <img src="{{'https://minotar.net/avatar/' + user.skin}}" alt="{{user.username}}" class="profile__avatar" [class.profile__avatar--online]="user.last_seen == 'conectado'">
        </div>
        <div class="profile__content-info">
          <div class="profile__header">
            <h3 class="profile__head">
              <span *ngIf="user.last_seen !== '0'">Última vez: {{user.last_seen | valueOf | amLocale: 'es' | amTimeAgo}}</span>
              <span *ngIf="user.last_seen === '0'" class="profile__head--online">Conectado ahora mismo</span>
              <span class="profile__head--tag" *ngIf="user.show_status">en {{user.last_game}}</span>
            </h3>
            <h3 class="profile__head">Nível en el juego: <span class="profile__head--tag">{{user.level}}</span></h3>
            <div class="profile__badges" *ngIf="groups && groups.length >= 1">
              <span *ngFor="let group of groups">
                <a *ngIf="group.badge_color && group.badge_link" [href]="group.badge_link" [style.background]="group.badge_color" class="profile__badge">{{group.name}}</a>
              </span>
            </div>
          </div>
        </div>
      </div>
      <div class="profile__content-section">
        <div class="profile__content-indicator">
          <span class="profile__number">
            {{friends.friends.length}}
          </span>
        </div>
        <div class="profile__content-info">
          <div class="profile__friends-title">
            <h3 class="profile__head">Amigo(s) en el servidor. <span>({{friends.commons}}) en común</span></h3>
          </div>
          <div class="profile__friends">
            <a *ngFor="let  friend of friends.friends" routerLink="{{'/' + friend.username}}" class="tooltip">
              <img src="{{'https://minotar.net/avatar/' + friend.skin}}" [alt]="friend.username" class="profile__friend" tooltip [content]="friend.username" placement="top">
            </a>
          </div>
        </div>
      </div>
      <div class="profile__content-section">
        <div class="profile__content-indicator">
          <span class="profile__number">
            {{won}}
          </span>
        </div>
        <div class="profile__content-info">
          <div class="profile__single-info">
            <h3 class="profile__head">Partidas ganadas</h3>
            <p class="paragraph">De {{played}} partidas jugadas desde que ingresó al servidor.</p>
          </div>
        </div>
      </div>
      <div class="profile__content-section">
        <div class="profile__content-indicator">
          <span class="profile__number">
            0
          </span>
        </div>
        <div class="profile__content-info">
          <div class="profile__single-info">
            <h3 class="profile__head">Puntos de logro</h3>
            <p class="paragraph">Obtenidos a lo largo de su historia.</p>
          </div>
        </div>
      </div>
    </div>
    <div class="profile__content--right" scrollbar>
      <a *ngFor="let match of matches" routerLink="{{'/partida/' + match._id}}" class="profile__match">
        <img src="{{'../../../../assets/images/games/' + match.gamemode._id + '.png'}}" [alt]="match.gamemode.name" class="profile__match-icon">
        <span class="profile__match-game">{{match.gamemode.name}}</span>
        <span *ngIf="match.winner.includes(user._id) && (match.status === 'finished' || match.status === 'forced')" class="profile__match-status profile__match-status--win">Victoria</span>
        <span *ngIf="!match.winner.includes(user._id) && (match.status === 'finished' || match.status === 'forced')" class="profile__match-status profile__match-status--lose">Derrota</span>
        <span *ngIf="match.status === 'ingame' || match.status === 'starting'" class="profile__match-status profile__match-status--alert">En juego</span>
        <span *ngIf="match.status === 'waiting'" class="profile__match-status profile__match-status--alert">Esperando</span>
        <span *ngIf="match.status === 'invalidated'" class="profile__match-status profile__match-status--alert">Invalidada</span>
      </a>
    </div>
  </div>
  <div class="profile__sections">
    <div class="profile__menu">
      <button class="tab__link tab__link--horizontal tab__link--active profile__section-selector" tab tab_id="profile">Perfil</button>
      <button *ngIf="maps && maps.length >= 1" class="tab__link tab__link--horizontal profile__section-selector" tab tab_id="maps">Mapas</button>
      <button class="tab__link tab__link--horizontal profile__section-selector" tab tab_id="achievements">Logros</button>
      <button class="tab__link tab__link--horizontal profile__section-selector" tab tab_id="stats">Estadísticas</button>
      <button class="tab__link tab__link--horizontal profile__section-selector" tab tab_id="punishments">Infracciones</button>
    </div>
    <div id="profile" class="tab tab--active profile__tab">
      <h1 class="heading">Perfil</h1>
      <div class="row profile__social-row">
        <div class="col-1-of-4" *ngIf="user.twitter">
          <span class="profile__social-title">Twitter</span>
          <div class="profile__social-link"><a href="{{'https://www.twitter.com/' + user.twitter}}">{{user.twitter}}</a></div>
        </div>
        <div class="col-1-of-4" *ngIf="user.reddit">
          <span class="profile__social-title">Reddit</span>
          <div class="profile__social-link"><a href="{{'https://www.reddit.com/' + user.reddit}}">{{user.reddit}}</a></div>
        </div>
        <div class="col-1-of-4" *ngIf="user.steam">
          <span class="profile__social-title">Steam</span>
          <div class="profile__social-link"><a href="{{'https://steamcommunity.com/id/' + user.steam}}">{{user.steam}}</a></div>
        </div>
        <div class="col-1-of-4">
          <span class="profile__social-title" *ngIf="user.twitch">Twitch</span>
          <div class="profile__social-link"><a href="{{'https://twitch.tv/' + user.twitch}}">{{user.twitch}}</a></div>
        </div>
      </div>
      <div class="row profile__social-row">
        <div class="col-1-of-2">
          <span class="profile__social-title">Email público</span>
          <div class="profile__social-field">
            <p class="paragraph paragraph--white" *ngIf="user.public_email">{{user.public_email}}</p>
            <p class="paragraph paragraph--white" *ngIf="!user.public_email">No hay información.</p>
          </div>
        </div>
        <div class="col-1-of-2">
          <span class="profile__social-title">Ocupación</span>
          <div class="profile__social-field">
            <p class="paragraph paragraph--white" *ngIf="user.occupation">{{user.occupation}}</p>
            <p class="paragraph paragraph--white" *ngIf="!user.occupation">No hay información.</p>
          </div>
        </div>
      </div>
      <div class="row profile__social-row">
        <div class="col-1-of-2">
          <span class="profile__social-title">Ubicación</span>
          <div class="profile__social-field">
            <p class="paragraph paragraph--white" *ngIf="user.location">{{user.location}}</p>
            <p class="paragraph paragraph--white" *ngIf="!user.location">No hay información.</p>
          </div>
        </div>
        <div class="col-1-of-2">
          <span class="profile__social-title">Interéses</span>
          <div class="profile__social-field">
            <p class="paragraph paragraph--white" *ngIf="user.interests">{{user.interests}}</p>
            <p class="paragraph paragraph--white" *ngIf="!user.interests">No hay información.</p>
          </div>
        </div>
      </div>
      <span class="profile__social-title">Acerca de mí</span>
      <div class="profile__social-field paragraph paragraph--white" *ngIf="!user.about">
        {{user.username}} no ha escrito nada aún.
      </div>
      <div class="profile__social-field paragraph--white" [innerHTML]="user.about | noSanitize" *ngIf="user.about"></div>
    </div>
    <div *ngIf="maps && maps.length >= 1" id="maps" class="tab profile__tab">
      <h2 class="heading">Mapas</h2>
      <div *ngFor="let map of maps" class="map map--profile">
        <a routerLink="{{'/mapas/' + map._id}}">
          <img src="{{url + 'map/get-image/' + map.image}}" class="map__image">
        </a>
        <a routerLink="{{'/mapas/' + map._id}}" class="map__title">
          {{map.name}}
        </a>
        <p class="map__author">
          por <a routerLink="{{'/' + user.username}}">{{user.username}}</a>
        </p>

        <!--
        <div class="map__stars">
          <fa-icon class="map__star map__star--active" [icon]="faStar"></fa-icon>
          <fa-icon class="map__star" [icon]="faStar"></fa-icon>
          <fa-icon class="map__star" [icon]="faStar"></fa-icon>
          <fa-icon class="map__star" [icon]="faStar"></fa-icon>
          <fa-icon class="map__star" [icon]="faStar"></fa-icon>
        </div>
        -->

      </div>
    </div>
    <div id="achievements" class="tab profile__tab">
      <h2 class="heading">Logros</h2>
    </div>
    <div id="stats" class="tab profile__tab">
      <h2 class="heading">Estadísticas</h2>

    </div>
    <div id="punishments" class="tab profile__tab">
      <h2 class="heading u-margin-bottom-small">Infracciones</h2>
      <p *ngIf="punishments.length === 0" class="paragraph paragraph--white u-center-text">¡Este usuario es un ejemplo a seguir! (No tiene infracciones)</p>
      <div *ngIf="punishments.length > 0" class="table">
        <div class="table__header">
          <div class="table__cell">
            <p>Hecha por</p>
          </div>
          <div class="table__cell">
            <p>Sancionado</p>
          </div>
          <div class="table__cell">
            <p>Razón</p>
          </div>
          <div class="table__cell">
            <p>Tipo</p>
          </div>
          <div class="table__cell">
            <p>Estado</p>
          </div>
          <div class="table__cell">
            <p>Fecha</p>
          </div>
        </div>
        <div class="table__row punishment__row table--fixed" *ngFor="let punishment of punishments">
          <div class="table__cell punishment__profile-others">
            <a color [id]="punishment.punisher"></a>
          </div>
          <div class="table__cell punishment__profile-others">
            <a color [id]="punishment.punished"></a>
          </div>
          <div class="table__cell punishment__profile-reason">
            <span>{{punishment.reason}}</span>
          </div>
          <div class="table__cell punishment__profile-others">
            <span *ngIf="punishment.type == 'warn'" style="color: green">{{punishment.type | titlecase}}</span>
            <span *ngIf="punishment.type =='kick'" style="color: orange">{{punishment.type | titlecase}}</span>
            <span *ngIf="punishment.type == 'ban'" style="color: red">{{punishment.type | titlecase}}</span>
          </div>
          <div class="table__cell punishment__profile-others">
            <span *ngIf="punishment.active && !punishment.automatic && !punishment.appealed">Activo</span>
            <span *ngIf="punishment.active && punishment.automatic" style="color: orange">Automatico</span>
            <span *ngIf="punishment.active && punishment.appealed" style="color: dodgerblue">En disputa</span>
            <span *ngIf="!punishment.active" style="color: green">Inactivo/Apelado</span>
          </div>
          <div class="table__cell">
            <a routerLink="{{ '/sancion/' + punishment._id}}">{{punishment.created_at | valueOf | amLocale: 'es' | amTimeAgo}}</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
